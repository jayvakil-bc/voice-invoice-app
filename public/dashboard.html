<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Voice Invoice Generator</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dashboard-styles.css">
</head>
<body>
    <div class="dashboard-header">
        <div class="header-left">
            <h2>üé§ Voice Invoice Generator</h2>
        </div>
        <div class="header-right">
            <div class="user-info">
                <img id="userAvatar" class="user-avatar" src="" alt="User">
                <span id="userName" class="user-name"></span>
            </div>
            <a href="/settings" style="text-decoration: none;">
                <button class="logout-btn" style="margin-right: 0.5rem;">‚öôÔ∏è Settings</button>
            </a>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </div>
    
    <div class="dashboard-content">
        <div class="actions">
            <a href="/create" class="create-btn">+ Create New Invoice</a>
            <a href="/create-contract" class="create-btn create-btn-contract">+ Create New Contract</a>
        </div>
        
        <!-- Tabs for Invoices and Contracts -->
        <div class="dashboard-tabs">
            <button class="tab-btn active" onclick="switchTab('invoices')">üìÑ Invoices</button>
            <button class="tab-btn" onclick="switchTab('contracts')">üìú Contracts</button>
        </div>
        
        <!-- Invoices Section -->
        <div id="invoicesTab" class="tab-content active">
            <div class="invoices-section">
                <div class="section-header">
                    <h2>Your Invoices</h2>
                    <p class="invoice-count">Total: <span id="invoiceCount">0</span></p>
                </div>
                <div id="invoicesList"></div>
            </div>
        </div>
        
        <!-- Contracts Section -->
        <div id="contractsTab" class="tab-content">
            <div class="contracts-section">
                <div class="section-header">
                    <h2>Your Contracts</h2>
                    <p class="invoice-count">Total: <span id="contractCount">0</span></p>
                </div>
                <div id="contractsList"></div>
            </div>
        </div>
    </div>
    
    <!-- Edit Invoice Modal -->
    <div id="editModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Invoice</h2>
                <button onclick="closeEditModal()" class="close-btn">‚úï</button>
            </div>
            <div class="modal-body">
                <textarea id="editTranscript" rows="10" class="edit-textarea"></textarea>
                <p class="modal-note">Edit the invoice description above, then regenerate the PDF</p>
            </div>
            <div class="modal-footer">
                <button onclick="closeEditModal()" class="btn-secondary">Cancel</button>
                <button onclick="saveAndRegenerate()" class="btn-primary">Regenerate Invoice</button>
            </div>
        </div>
    </div>
    
    <!-- Preview Invoice Modal -->
    <div id="previewModal" class="modal hidden">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>üìÑ Invoice Preview</h2>
                <button onclick="closePreviewModal()" class="close-btn">‚úï</button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <div class="preview-section">
                    <div class="preview-header">
                        <div>
                            <label>Invoice Number:</label>
                            <input type="text" id="preview_invoiceNumber" class="preview-input">
                        </div>
                        <div>
                            <label>Date:</label>
                            <input type="date" id="preview_date" class="preview-input">
                        </div>
                        <div>
                            <label>Due Date:</label>
                            <input type="date" id="preview_dueDate" class="preview-input">
                        </div>
                    </div>
                    
                    <div class="preview-parties">
                        <div class="preview-party">
                            <h3>From:</h3>
                            <input type="text" id="preview_from_name" placeholder="Company Name" class="preview-input">
                            <textarea id="preview_from_address" placeholder="Address" class="preview-input" rows="2"></textarea>
                            <input type="text" id="preview_from_phone" placeholder="Phone" class="preview-input">
                            <input type="email" id="preview_from_email" placeholder="Email" class="preview-input">
                        </div>
                        <div class="preview-party">
                            <h3>Bill To:</h3>
                            <input type="text" id="preview_to_name" placeholder="Client Name" class="preview-input">
                            <textarea id="preview_to_address" placeholder="Address" class="preview-input" rows="2"></textarea>
                            <input type="text" id="preview_to_phone" placeholder="Phone" class="preview-input">
                            <input type="email" id="preview_to_email" placeholder="Email" class="preview-input">
                        </div>
                    </div>
                    
                    <div class="preview-items">
                        <h3>Items:</h3>
                        <div id="preview_items_list"></div>
                    </div>
                    
                    <div class="preview-totals">
                        <div class="total-row">
                            <span>Subtotal:</span>
                            <input type="number" id="preview_subtotal" class="preview-input" readonly style="background: #f5f5f5;">
                        </div>
                        <div class="total-row">
                            <span>Tax:</span>
                            <input type="number" id="preview_tax" class="preview-input" step="0.01">
                        </div>
                        <div class="total-row total-final">
                            <span>TOTAL:</span>
                            <input type="number" id="preview_total" class="preview-input" readonly style="background: #f5f5f5;">
                        </div>
                    </div>
                    
                    <div class="preview-notes">
                        <label>Notes / Payment Terms:</label>
                        <textarea id="preview_notes" class="preview-input" rows="3"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closePreviewModal()" class="btn-secondary">Cancel</button>
                <button onclick="savePreviewChanges()" class="btn-primary">üíæ Save Changes</button>
                <button onclick="downloadFromPreview()" class="btn-primary" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">üì• Download PDF</button>
            </div>
        </div>
    </div>
    
    <script src="dashboard.js"></script>
</body>
</html>
